<div class="container">
  <!-- Filter section -->
  <div class="row mb-3 filter-section">
    <div class="col">
      <button class="btn btn-outline-secondary">
        <i class="fa fa-filter"></i> Filters
      </button>
    </div>
  </div>
  
  <!-- Entries and Export section -->
  <div class="row mb-3">
    <div class="col-md-2 entries-selector">
      <label>Show 
        <select class="form-select form-select-sm d-inline-block w-auto" [(ngModel)]="entriesPerPage">
          <option value="25">25</option>
          <option value="50">50</option>
          <option value="100">100</option>
        </select>
      </label>
      entries
    </div>
    <div class="col-md-10 export-buttons">
      <button class="btn btn-light btn-sm me-2" (click)="exportCSV()">
        <i class="fa fa-file-csv"></i> Export CSV
      </button>
      <button class="btn btn-light btn-sm me-2" (click)="exportExcel()">
        <i class="fa fa-file-excel"></i> Export Excel
      </button>
      <button class="btn btn-light btn-sm me-2" (click)="printData()">
        <i class="fa fa-print"></i> Print
      </button>
      <button class="btn btn-light btn-sm me-2" (click)="toggleColumnVisibility()">
        <i class="fa fa-columns"></i> Column visibility
      </button>
      <div class="dropdown column-visibility-dropdown" *ngIf="showColumnMenu">
        <div class="dropdown-header">
       
        </div>
        <div class="dropdown-item" *ngFor="let column of columns">
          <div class="form-check">
            <input class="form-check-input" type="checkbox" [id]="'col-' + column.field" [(ngModel)]="column.visible" (change)="updateColumnVisibility()">
            <label class="form-check-label" [for]="'col-' + column.field">
              {{ column.header }}
            </label>
          </div>
        </div>
        <div class="dropdown-divider"></div>
        <div class="dropdown-item">
       
        </div>
      </div>
      <button class="btn btn-light btn-sm me-2" (click)="exportPDF()">
        <i class="fa fa-file-pdf"></i> Export PDF
      </button>
      <button class="btn btn-primary btn-sm" (click)="navigateToAddSales()">
        <i class="fa fa-plus"></i> Add Sales Order
      </button>
    </div>
  </div>
  
  <!-- Search section -->
  <div class="row mb-3 search-section">
    <div class="col">
      <input type="text" class="form-control" placeholder="Search..." [(ngModel)]="searchTerm" (input)="applyFilters()">
    </div>
  </div>
  
  <!-- Table section -->
  <div class="table-responsive">
    <table class="table table-hover no-vertical-lines">
      <thead>
        <tr>
          <th>S.No</th>
          <th>Customer <i class="fa fa-sort"></i></th>
          <th>Sale Date <i class="fa fa-sort"></i></th>
          <th>Invoice No <i class="fa fa-sort"></i></th>
          <th>Status <i class="fa fa-sort"></i></th>
          <th>Shipping Status <i class="fa fa-sort"></i></th>
          <th>Payment Amount <i class="fa fa-sort"></i></th>
          <th>Balance <i class="fa fa-sort"></i></th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let sale of filteredSales | slice: (currentPage-1)*entriesPerPage : currentPage*entriesPerPage; let i = index">
          <td>{{ (currentPage-1)*entriesPerPage + i + 1 }}</td>
          <td>{{ sale.customer }}</td>
          <td>{{ sale.saleDate | date:'M/d/yy' }}</td>
          <td>{{ sale.invoiceNo }}</td>
          <td>
            <span class="badge" [ngClass]="{
              'bg-success': sale.status === 'Completed',
              'bg-warning': sale.status === 'Pending',
              'bg-danger': sale.status === 'Cancelled'
            }">
              {{ sale.status }}
            </span>
          </td>
          <td>{{ sale.shippingStatus }}</td>
          <td>${{ sale.paymentAmount | number:'1.2-2' }}</td>
          <td>${{ sale.balance | number:'1.2-2' }}</td>
          <td class="action-buttons">
            <button class="btn btn-info btn-sm me-1" (click)="viewSale(sale)">
              <i class="fa fa-eye"></i>
            </button>
            <button class="btn btn-danger btn-sm" (click)="deleteSale(sale.id)">
              <i class="fa fa-trash"></i>
            </button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
  
  <!-- Sale Details Modal -->
  <div class="modal fade" id="saleDetailsModal" tabindex="-1" aria-labelledby="saleDetailsModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="saleDetailsModalLabel">Sale Details - Invoice #{{ selectedSale?.invoiceNo }}</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <div class="row mb-3">
            <div class="col-md-6">
              <h6>Customer Information</h6>
              <p><strong>Name:</strong> {{ selectedSale?.customer }}</p>
              <p><strong>Contact:</strong> {{ selectedSale?.customerPhone }}</p>
              <p><strong>Email:</strong> {{ selectedSale?.customerEmail }}</p>
            </div>
            <div class="col-md-6">
              <h6>Order Information</h6>
              <p><strong>Date:</strong> {{ selectedSale?.saleDate | date:'mediumDate' }}</p>
              <p><strong>Status:</strong> 
                <span class="badge" [ngClass]="{
                  'bg-success': selectedSale?.status === 'Completed',
                  'bg-warning': selectedSale?.status === 'Pending',
                  'bg-danger': selectedSale?.status === 'Cancelled',
                  'bg-primary': selectedSale?.status === 'Active'  
                }">
                  {{ selectedSale?.status }}
                </span>
              </p>
              
              <p><strong>Shipping:</strong> {{ selectedSale?.shippingStatus }}</p>
            </div>
          </div>
          
          <div class="row mb-3">
            <div class="col-12">
              <h6>Items</h6>
              <table class="table table-sm">
                <thead>
                  <tr>
                    <th>Item</th>
                    <th>Quantity</th>
                    <th>Price</th>
                    <th>Total</th>
                  </tr>
                </thead>
                <tbody>
                  <tr *ngFor="let item of selectedSale?.items">
                    <td>{{ item.name }}</td>
                    <td>{{ item.quantity }}</td>
                    <td>${{ item.price | number:'1.2-2' }}</td>
                    <td>${{ (item.price * item.quantity) | number:'1.2-2' }}</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
          
          <div class="row">
            <div class="col-md-6">
              <h6>Shipping Information</h6>
              <p>{{ selectedSale?.shippingAddress }}</p>
            </div>
            <div class="col-md-6 text-end">
              <div class="totals">
                <p><strong>Subtotal:</strong> ${{ selectedSale?.subtotal | number:'1.2-2' }}</p>
                <p><strong>Tax:</strong> ${{ selectedSale?.tax | number:'1.2-2' }}</p>
                <p><strong>Shipping:</strong> ${{ selectedSale?.shippingCost | number:'1.2-2' }}</p>
                <p><strong>Total:</strong> ${{ selectedSale?.total | number:'1.2-2' }}</p>
                <p><strong>Paid:</strong> ${{ selectedSale?.paymentAmount | number:'1.2-2' }}</p>
                <p><strong>Balance:</strong> ${{ selectedSale?.balance | number:'1.2-2' }}</p>
              </div>
            </div>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
          <button type="button" class="btn btn-primary" (click)="printInvoice()">
            <i class="fa fa-print"></i> Print Invoice
          </button>
        </div>
      </div>
    </div>
  </div>
  
  <!-- Pagination section -->
  <div class="row">
    <div class="col pagination-info">
      Showing {{ (currentPage-1)*entriesPerPage + 1 }} to {{ currentPage*entriesPerPage > totalEntries ? totalEntries : currentPage*entriesPerPage }} of {{ totalEntries }} entries
    </div>
    <div class="col pagination-controls">
      <button class="btn btn-light btn-sm me-2" [disabled]="currentPage === 1" (click)="previousPage()">Previous</button>
      <button class="btn btn-light btn-sm" [disabled]="currentPage*entriesPerPage >= totalEntries" (click)="nextPage()">Next</button>
    </div>
  </div>
</div>