<!-- Button to open modal -->
<button (click)="openModal()" class="add-button">Add+</button>

<!-- Modal for adding/editing a modifier -->
<div *ngIf="isModalOpen" class="modal">
  <div class="modal-content">
    <h2>{{ editingModifierId ? 'Edit' : 'Add' }} Modifier</h2>
    <form [formGroup]="modifierForm">
      <div class="form-group">
        <label for="modifierSet">Modifier Set:</label>
        <input id="modifierSet" formControlName="modifierSet" type="text" />
        <div *ngIf="modifierForm.get('modifierSet')?.invalid && modifierForm.get('modifierSet')?.touched" class="error-message">
          Modifier Set is required.
        </div>
      </div>

      <div class="modifiers-section">
        <h3>Modifiers</h3>
        <div formArrayName="modifiers">
          <div *ngFor="let modifier of modifiers.controls; let i = index" [formGroupName]="i" class="modifier-row">
            <div class="form-group">
              <label [for]="'modifierName' + i">Modifier Name:</label>
              <input [id]="'modifierName' + i" formControlName="name" type="text" />
              <div *ngIf="modifiers.at(i).get('name')?.invalid && modifiers.at(i).get('name')?.touched" class="error-message">
                Name is required.
              </div>
            </div>
            <div class="form-group">
              <label [for]="'modifierPrice' + i">Price:</label>
              <input [id]="'modifierPrice' + i" formControlName="price" type="number" min="0" step="0.01" />
              <div *ngIf="modifiers.at(i).get('price')?.invalid && modifiers.at(i).get('price')?.touched" class="error-message">
                Valid price is required.
              </div>
            </div>
            <button type="button" (click)="removeModifier(i)" *ngIf="modifiers.length > 1" class="remove-button">
              Remove
            </button>
          </div>
        </div>

        <button type="button" (click)="addModifier()" class="add-modifier-button">+ Add Modifier</button>
      </div>

      <div class="modal-actions">
        <button type="button" (click)="saveModifier()" class="save-button" [disabled]="modifierForm.invalid">
          {{ editingModifierId ? 'Update' : 'Save' }}
        </button>
        <button type="button" (click)="closeModal()" class="cancel-button">Cancel</button>
      </div>
    </form>
  </div>
</div>

<!-- Search Input -->
<div class="search-container">
  <input [(ngModel)]="searchQuery" placeholder="Search modifiers..." class="search-input" />
</div>

<!-- Table for displaying modifiers -->
<div class="table-container">
  <table *ngIf="modifiersData.length > 0">
    <thead>
      <tr>
        <th>Modifier Sets</th>
        <th>Modifiers</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let modifier of filteredModifiers()">
        <td>{{ modifier.modifierSet }}</td>
        <td>{{ getFormattedModifiers(modifier) }}</td>
        <td class="action-buttons">
          <button (click)="editModifier(modifier.id)" class="edit-button">Edit</button>
          <button (click)="deleteModifier(modifier.id)" class="delete-button">Delete</button>
        </td>
      </tr>
    </tbody>
  </table>

  <div *ngIf="modifiersData.length === 0" class="empty-state">
    <p>No modifiers found. Click "Add+" to create your first modifier set.</p>
  </div>
</div>
